<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Provider Enrollment Form</title>
<style>
body { 
  font-family: 'Segoe UI', sans-serif; 
  background: #f5f7fa; 
  padding: 24px; 
}
form { 
  width: 50%; 
  margin: auto; 
}
.card { 
  background: #fff; 
  border-radius: 10px; 
  padding: 18px; 
  margin: 14px 0; 
  box-shadow: 0 3px 8px rgba(0,0,0,.08);
}
label { 
  display:block; 
  font-weight:600; 
  margin-bottom:6px;
}
input, textarea { 
  width:100%; 
  padding:10px; 
  border:1px solid #ccc; 
  border-radius:6px; 
  box-sizing:border-box;
}
.add-btn { 
  background:#009688; 
  color:#fff; 
  border:none; 
  padding:8px 12px; 
  border-radius:6px; 
  cursor:pointer;
}
button[type=submit]{ 
  background:#007bff; 
  color:#fff; 
  padding:12px 20px; 
  border:none; 
  border-radius:8px; 
  cursor:pointer; 
  font-size:16px;
}
.owner-only { display:none; }

#thankYouMessage { 
  display: none; 
  text-align:center; 
  padding: 20px; 
  font-size:18px; 
  background: #d4edda; 
  color: #155724; 
  border-radius: 8px; 
  max-width: 800px; 
  margin: 20px auto; 
}

/* ✅ Required field asterisk */
label.required .label-text::after {
  content: " *";
  color: red;
}

/* ✅ Radio alignment */
.radio-group {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.radio-option {
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
}
.option-text {
  flex: 1;
  text-align: left;
}
.radio-box {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
}
.radio-option input[type="radio"] {
  margin: 0;
}

/* ✅ Row layout for side-by-side fields */
.row {
  display: flex;
  gap: 16px;
}
.row label {
  flex: 1;
}
</style>
</head>
<body>

<h2 style="text-align:center;">Provider Enrollment Form</h2>

<div id="thankYouMessage">
  ✅ Thank you for your submission.<br>
  One of our enrollment specialists will begin processing your form and contact you if we need more information.
</div>

<form id="enrollmentForm" method="post" enctype="multipart/form-data">
  <div class="card">
    <h3>Select Role<span style="color:red;"> *</span></h3>
    <div class="radio-group">
      <label class="radio-option">
        <span class="option-text">Provider joining a group practice</span>
        <span class="radio-box"><input type="radio" name="role" value="provider" required></span>
      </label>
      <label class="radio-option">
        <span class="option-text">Owner of a practice</span>
        <span class="radio-box"><input type="radio" name="role" value="owner" required></span>
      </label>
    </div>
  </div>

  <!-- Practice Info -->
  <div id="practiceSection" style="display:none;">
    <div class="card">
      <h3>Practice Information</h3>
      <label class="required"><span class="label-text">Practice Name</span><input name="practiceName" required></label>

      <div class="row">
        <label><span class="label-text">Practice Contact First Name</span><input name="practiceContactFirstName"></label>
        <label><span class="label-text">Practice Contact Last Name</span><input name="practiceContactLastName"></label>
      </div>

      <div class="row">
        <label><span class="label-text">Email</span><input type="email" name="practiceContactEmail"></label>
        <label><span class="label-text">Phone</span><input name="practiceContactPhone"></label>
      </div>

      <label class="required"><span class="label-text">Service Location(s)</span><input name="serviceLocation[]" required></label>
      <button type="button" class="add-btn" onclick="addServiceLocation()">+ Add Another Location</button>

      <!-- Owner-only fields -->
      <label class="owner-only"><span class="label-text">Billing Address</span><input name="billingAddress"></label>
      <label class="owner-only required"><span class="label-text">Tax ID</span><input name="taxId" required></label>
      <label class="owner-only"><span class="label-text">Group NPI</span><input name="groupNpi"></label>
      <label class="owner-only"><span class="label-text">Group Medicare PTAN/ID</span><input name="groupMedicare"></label>
      <label class="owner-only"><span class="label-text">Group Medicaid ID</span><input name="groupMedicaid"></label>

      <label><span class="label-text">Counties you are seeing patients of</span><input name="counties"></label>
      <label class="required"><span class="label-text">Office Phone</span><input name="officePhone" required></label>
      <label><span class="label-text">FAX</span><input name="fax"></label>
    </div>
  </div>

  <!-- Provider Info -->
  <div id="providerSection" style="display:none;">
    <div class="card">
      <h3>Provider Information</h3>

      <div class="row">
        <label class="required"><span class="label-text">First Name</span><input name="providerFirstName" required></label>
        <label><span class="label-text">Middle Initial</span><input name="providerMiddleInitial"></label>
        <label class="required"><span class="label-text">Last Name</span><input name="providerLastName" required></label>
      </div>

      <label><span class="label-text">Individual NPI</span><input name="individualNpi"></label>
      <label><span class="label-text">Medicare ID</span><input name="individualMedicare"></label>
      <label><span class="label-text">Medicaid ID</span><input name="individualMedicaid"></label>
      <label class="required"><span class="label-text">SSN</span><input name="ssn" required></label>
      <label class="required"><span class="label-text">DOB</span><input type="date" name="dob" required></label>
      <label><span class="label-text">License</span><input name="license"></label>
      <label><span class="label-text">CAQH ID</span><input name="caqhId"></label>

      <div class="row">
        <label class="required"><span class="label-text">Email</span><input type="email" name="email" required></label>
        <label><span class="label-text">Cell</span><input name="cell"></label>
      </div>

      <label class="required"><span class="label-text">Home Address</span><input name="homeAddress" required></label>
      <label><span class="label-text">Taxonomy</span><input name="taxonomy"></label>
      <label><span class="label-text">Specialty</span><input name="specialty"></label>
      <label><span class="label-text">Languages Spoken</span><input name="languages"></label>
    </div>

    <div class="card">
      <h3>Logins</h3>
      <div class="row">
        <label><span class="label-text">PECOS Username</span><input name="pecosLogin"></label>
        <label><span class="label-text">PECOS Password</span><input type="password" name="pecosPassword"></label>
      </div>
      <div class="row">
        <label><span class="label-text">CAQH Username</span><input name="caqhLogin"></label>
        <label><span class="label-text">CAQH Password</span><input type="password" name="caqhPassword"></label>
      </div>
    </div>

    <div class="card">
      <h3>Documents Upload</h3>
      <label class="required"><span class="label-text">Copy of License</span><input type="file" name="licenseFile" required></label>
      <label class="required"><span class="label-text">Copy of Educational Degree</span><input type="file" name="degreeFile" required></label>
      <label><span class="label-text">Copy of Malpractice</span><input type="file" name="malpracticeFile"></label>
      <label class="required"><span class="label-text">Resume</span><input type="file" name="resumeFile" required></label>
      <label class="owner-only"><span class="label-text">W9 Form</span><input type="file" name="w9File"></label>
      <label class="owner-only"><span class="label-text">Voided Check</span><input type="file" name="checkFile"></label>
      <label class="owner-only"><span class="label-text">Copy of IRS Letter</span><input type="file" name="irsFile"></label>
    </div>

    <div class="card">
      <h3>Special Instructions</h3>
      <label><span class="label-text">Notes for Credentialing Team</span><textarea name="specialInstructions" rows="4"></textarea></label>
    </div>
  </div>

  <button type="submit">Submit</button>
</form>

<script>
const webAppUrl = "https://script.google.com/macros/s/AKfycbzeT9gewu_K01avi8hgdxomRpHvuS8M3oyqjwAHxQb9DJwjbKTGZgNJdJ442oONnHYZbw/exec";

document.querySelectorAll('input[name="role"]').forEach(radio => {
  radio.addEventListener('change', e => {
    document.getElementById('practiceSection').style.display = 'block';
    document.getElementById('providerSection').style.display = 'block';
    document.querySelectorAll('.owner-only').forEach(f => {
      f.style.display = e.target.value === 'owner' ? 'block' : 'none';
    });
  });
});

function addServiceLocation() {
  const parent = document.querySelector('input[name="serviceLocation[]"]').parentNode;
  const input = document.createElement('input');
  input.type = 'text';
  input.name = 'serviceLocation[]';
  input.placeholder = 'Additional Service Location';
  input.style.marginTop = '6px';
  parent.appendChild(input);
}

document.getElementById('enrollmentForm').addEventListener('submit', function(e){
  e.preventDefault();
  const form = e.target;
  const data = {};
  const files = {};

  [...form.elements].forEach(el => {
    if(el.name){
      if(el.type==='file' && el.files.length){
        for(let f of el.files){
          const reader = new FileReader();
          reader.onload = evt => { 
            files[f.name] = {name:f.name, type:f.type, content:evt.target.result.split(',')[1]}; 
          };
          reader.readAsDataURL(f);
        }
      } else if(el.name.endsWith('[]')){
        if(!data[el.name]) data[el.name] = [];
        data[el.name].push(el.value);
      } else {
        data[el.name] = el.value;
      }
    }
  });

  setTimeout(() => {
    data.files = files;
    fetch(webAppUrl, {
      method:'POST',
      body:JSON.stringify(data)
    })
    .then(res => res.json())
    .then(res => {
      if(res.status === 'success'){
        form.reset();
        form.style.display = 'none';
        document.getElementById("thankYouMessage").style.display = 'block';
      } else {
        alert("Error: " + res.message);
      }
    })
    .catch(() => {
      alert("Something went wrong. Please try again.");
    });
  }, 1000);
});
</script>

</body>
</html>
